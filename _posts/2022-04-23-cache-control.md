---
title: HTTP Cacheë¡œ ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë°©ì§€í•˜ê¸°
categories: TIL
tags: [TIL, HTTP]
excerpt: ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ìµœì í™”í•˜ê¸° ìœ„í•œ HTTP ìºì‹œ ì²˜ë¦¬ ë°©ë²•ì„ ì•Œì•„ë³´ìž!
---

ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì€ ëŠë¦¬ê³  ë¹„ìš©ì´ ë§Žì´ ë“¤ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ë¥¼ ìµœëŒ€í•œ ë°©ì§€í•´ì•¼ í•œë‹¤.  
ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìžˆëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ê°€ ë°”ë¡œ `HTTP Cache`ì´ë‹¤.

# HTTP Cache

ì›¹ ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì—ì„œ ì§€ê¸ˆê¹Œì§€ ìš”ì²­í•œ ì ì´ ì—†ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¤ë ¤ê³  í•  ë•Œ, ì„œë²„ì™€ ë¸Œë¼ìš°ì €ëŠ” ì™„ì „í•œ HTTP ìš”ì²­/ì‘ë‹µì„ ì£¼ê³ ë°›ê³ , ì´í›„ì—ëŠ” HTTP ìš”ì²­ í—¤ë”ì™€ ì‘ë‹µ í—¤ë”ì— í¬í•¨ëœ ìºì‹œ ì„¤ì •ì— ë”°ë¼ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì „ë‹¬í• ì§€, ë¦¬ì†ŒìŠ¤ë¥¼ ìƒˆë¡œ ë°›ì•„ì˜¬ì§€ ê²°ì •ëœë‹¤.

# ì‘ë‹µ í—¤ë”ì—ì„œ ìºì‹± ì„¤ì •

ì‘ë‹µ í—¤ë”ì—ì„œ ì„¤ì •í•  ìˆ˜ ìžˆëŠ” ìºì‹± ì„¤ì •ì˜ ì¢…ë¥˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

- `Cache-Control` : ìºì‹œì˜ ìˆ˜ëª…ì„ ê²°ì •í•  ìˆ˜ ìžˆë‹¤.
- `ETag` : ì»¨í…ì¸ ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ëŠ” íƒœê·¸.
  ê°™ì€ ì£¼ì†Œì˜ ìžì›ì´ë¼ë„ ì»¨í…ì¸ ê°€ ë‹¬ë¼ì¡Œìœ¼ë©´ ETagê°€ ë‹¤ë¦„.
  ì„œë²„ëŠ” ì„œë²„ ì»¨í…ì¸ (response body)ê°€ ë‹¬ë¼ì¡ŒìŒì„ ETagë¥¼ ë³´ê³  í™•ì¸í•˜ì—¬ ìºì‹œë¥¼ ì§€ìš°ê³  ìƒˆë¡œ ì»¨í…ì¸ ë¥¼ ë‚´ë ¤ ë°›ëŠ”ë‹¤.
- `Last-Modified` : ë¦¬ì†ŒìŠ¤ê°€ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•œë‹¤.

ETagì™€ Last-Modified ê°’ì€ ê¸°ì¡´ì— ë°›ì•˜ë˜ ë¦¬ì†ŒìŠ¤ì˜ ì‘ë‹µ í—¤ë”ì— ìžˆëŠ” ê°’ì„ ì‚¬ìš©í•œë‹¤.

# Cache-Control

ìºì‹œëœ ë¬¸ì„œì˜ ë§Œë£Œ ì‹œê°„ì´ ê°€ê¹Œì›Œì ¸ì˜¤ë©´, ë¬¸ì„œê°€ ê²€ì¦ë˜ê±°ë‚˜ ë‹¤ì‹œ ë¶ˆëŸ¬ì™€ì§€ê²Œ ëœë‹¤.

## Cache-Control ê°’ ì¢…ë¥˜

- `max-age` : ì´ˆ ë‹¨ìœ„ë¡œ ìºì‹œì˜ ì‹ ì„ ë„(ìˆ˜ëª…)ì„ ê²°ì •í•œë‹¤. `60\*60 = 3600`ì„ ìž…ë ¥í•˜ë©´ 1ì‹œê°„ ë™ì•ˆ ìºì‹œê°€ ìœ ì§€ëœë‹¤. ê·¸ ì´í›„ì—ëŠ” ì„œë²„ì— ìš”ì²­í•œ ë’¤ 304 ì‘ë‹µì„ ë°›ì„ ë•Œì—ë§Œ ìºì‹œë¥¼ ì´ìš©í•œë‹¤.
- `s-maxage`: í”„ë¡ì‹œ ìºì‹œ(CDN ìºì‹±)ì— ëŒ€í•´ì„œë§Œ max-age ì§€ì‹œë¬¸ì„ ìž¬ì •ì˜í•˜ê³ , ì½˜í…ì¸ ë¥¼ ìºì‹œí•  ìˆ˜ ìžˆëŠ” ì‹œê°„ì„ ì´ˆ ë‹¨ìœ„ë¡œ CDNì— ì „ë‹¬í•œë‹¤. ì§€ì •ëœ ì‹œê°„ì´ ë§Œë£Œë˜ë©´ CDNì€ ì›ë³¸ ì„œë²„ì—ì„œ ì½˜í…ì¸ ë¥¼ ë‹¤ì‹œ ê²€ì¦í•´ì•¼ í•œë‹¤.
- `no-cache` : ìºì‹œê°€ ìœ íš¨í•œì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ë§¤ë²ˆ ì„œë²„ì— ìœ íš¨ì„± ê²€ì¦ì„ ìš”ì²­í•´ì•¼ í•œë‹¤.
- `no-store` : ì–´ë–¤ ì‘ë‹µë„ ìºì‹œë¡œ ì €ìž¥í•˜ì§€ ì•ŠëŠ”ë‹¤. ë°ì´í„°ì— ë¯¼ê°í•œ ì •ë³´ê°€ ìžˆì„ ë•Œ ì‚¬ìš©í•œë‹¤.
- `private`: ë¸Œë¼ìš°ì €ëŠ” íŒŒì¼ì„ ìºì‹œí•  ìˆ˜ ìžˆì§€ë§Œ ì¤‘ê°„ ìºì‹œëŠ” ìºì‹œí•  ìˆ˜ ì—†ë‹¤.(íƒ€ì¸ê³¼ ê³µìœ ë˜ëŠ” í”„ë¡ì‹œ ì„œë²„ì—ëŠ” ìºì‹œë¥¼ ì €ìž¥í•˜ì§€ ì•ŠëŠ”ë‹¤.) ê¸°ë³¸ì ìœ¼ë¡œ Cache-Controlì€ privateë¡œ ì„¤ì •ëœë‹¤.
- `public`: ëª¨ë“  ì‘ë‹µì„ ìºì‹œë¡œ ì €ìž¥í•œë‹¤.

  > \* ì›¹ ë¸Œë¼ìš°ì €ë‚˜ ë¡œì»¬ì— ì €ìž¥ë˜ëŠ” ìºì‹œëŠ” private ìºì‹œë¼ ë¶€ë¥´ê³  ì›ì„œë²„ì™€ ë¸Œë¼ìš°ì € ì‚¬ì´ì˜ í”„ë¡ì‹œ ìºì‹œ ì„œë²„ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìºì‹œëŠ” public ìºì‹œë¼ê³  ë¶€ë¥¸ë‹¤.

- **must-revalidate**: ìºì‹œê°€ ë§Œë£Œë˜ì—ˆë‹¤ë©´ ë°˜ë“œì‹œ ì› ì„œë²„ì— ê²€ì¦ ìš”ì²­ì„ ë³´ë‚´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ë§Œë£Œëœ HTTP ì‘ë‹µì„ ë°›ì•„ë“¤ì´ë„ë¡ ì„¤ì •ì´ ë˜ì–´ ìžˆëŠ” ìºì‹œì¼ì§€ë¼ë„ ë§ˆì°¬ê°€ì§€ë¡œ ì ìš©ëœë‹¤.
  - ë§Œì¼ ì–´ë–¤ ì»¨í…ì¸ ê°€ ê³µìœ  ìºì‹œë¡œ ì„¤ì •ë˜ì–´ ìžˆë‹¤ë©´ í”„ë¡ì‹œ ì„œë²„ë‹¨ì—ì„œ ìºì‹œë¥¼ ëŒë ¤ì¤„ ìˆ˜ ìžˆê¸°ë•Œë¬¸ì— ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ ì •ì±…ì´ë‹¤.
  - ì›ì„œë²„ì— ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì—ëŠ” ë°˜ë“œì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•´ì•¼ í•œë‹¤
  - ê¸ˆìœµ ë°ì´í„° ë“±ì— ì‚¬ìš©ëœë‹¤

## ì™„ë²½í•œ ìºì‹œ ë¬´íš¨í™” ë°©ë²•

ì™„ë²½í•˜ê²Œ ìºì‹œë¥¼ ë¬´íš¨í™”í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ëž˜ì™€ ê°™ì´ Cache-Control ê°’ì„ ì„¤ì •í•  ìˆ˜ ìžˆë‹¤.

```
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
```

\* `Pragma` í—¤ë”ëŠ” HTTP/1.1ì˜ Cache-Control í—¤ë”ê°€ ìƒê¸°ê¸° ì „ì— ë™ì¼í•œ ì—­í• ë¡œ ì‚¬ìš©ë˜ë˜ í—¤ë”ì´ë‹¤.
`Pragma: no-cache`ëŠ” `Cache-Control: no-cache`ì™€ ë™ì¼í•˜ë©°, HTTP/1.0ì„ ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ìƒëžµí•´ë„ ëœë‹¤.
(ë¹„ìŠ·í•˜ê²Œ Expiresë„ HTTP/1.0ì´ë©°, ëŒ€ì‘ë˜ëŠ” Cache-Controlì€ `max-age`ì´ë‹¤. í•¨ê»˜ ì‚¬ìš© ì‹œ ExpiresëŠ” ë¬´ì‹œëœë‹¤.)

# ìž¬ê²€ì¦ ìš”ì²­ (ìš”ì²­ í—¤ë”)

ìºì‹œì˜ ìœ íš¨ ê¸°ê°„ì´ ì§€ë‚˜ë©´ ìºì‹œëŠ” ì™„ì „ížˆ ì‚¬ë¼ì§€ëŠ” ê²ƒì´ ì•„ë‹ˆê³ , ë¸Œë¼ìš°ì €ëŠ” ì„œë²„ì— ìºì‹œê°€ ìœ íš¨í•œì§€ **ìž¬ê²€ì¦(Revalidation)**ì„ ìš”ì²­í•˜ëŠ” ì¡°ê±´ë¶€ ìš”ì²­(Conditional request)ì„ ìˆ˜í–‰í•œë‹¤.
ëŒ€í‘œì ì¸ ìž¬ê²€ì¦ ìš”ì²­ í—¤ë”ë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- `If-None-Match` : ìºì‹œëœ ë¦¬ì†ŒìŠ¤ì˜ ETag ê°’ê³¼ í˜„ìž¬ ì„œë²„ ë¦¬ì†ŒìŠ¤ì˜ ETag ê°’ì´ ê°™ì€ì§€ í™•ì¸í•˜ì—¬ ë‹¤ë¥¼ ê²½ìš°ì—ë§Œ ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- `If-Modified-Since`: ìºì‹œëœ ë¦¬ì†ŒìŠ¤ì˜ Last-Modified ê°’ ì´í›„ì— ì„œë²„ ë¦¬ì†ŒìŠ¤ê°€ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤.

> ðŸ“– ì°¸ê³ 
>
> - [ì›¹ ì„œë¹„ìŠ¤ ìºì‹œ ë˜‘ë˜‘í•˜ê²Œ ë‹¤ë£¨ê¸°](https://toss.tech/article/jscodeshift)
> - [HTTP Cacheë¡œ ë¶ˆí•„ìš”í•œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë°©ì§€](https://web.dev/i18n/ko/http-cache/)
> - [mdn web docs](https://developer.mozilla.org/ko/docs/Web/HTTP/Caching)
